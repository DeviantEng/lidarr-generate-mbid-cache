# /data/config.ini
# Enhanced configuration for concurrent cache warming

[lidarr]
# set to your ip/url
base_url = http://192.168.1.103:8686
api_key  = REPLACE_WITH_YOUR_LIDARR_API_KEY

[probe]
# API endpoint to probe for each MBID
target_base_url = https://api.lidarr.audio/api/v0.4
timeout_seconds = 10

# Per-artist cache warming settings
# Try each artist up to 25 times to warm cache
max_attempts_per_artist = 25
# Wait 0.5 seconds between attempts for same artist
delay_between_attempts = 0.5

# Concurrent request settings
# Number of simultaneous requests
max_concurrent_requests = 5
# Maximum API calls per second (safety valve)
rate_limit_per_second = 3

# Circuit breaker settings (stops run if API is completely broken)
# Stop after this many artists fail completely in a row
circuit_breaker_threshold = 25
# How aggressively to back off on errors
backoff_factor = 2.0
# Maximum wait time before retrying
max_backoff_seconds = 60

[ledger]
csv_path = /data/mbids.csv

[run]
# Re-check successes if true (or pass --force to the script directly)
force = false

# Processing options (frequent saves for safety)
# Process in batches of 25 artists
batch_size = 25
# Save progress every 5 requests
batch_write_frequency = 5

[schedule]
# Run every N seconds (>=1). Example: 3600 = hourly
interval_seconds = 3600

# Run immediately when container starts (true/false)
run_at_start = true

# Optional: randomize pre-run delay each time, 0 to N seconds
jitter_seconds = 0

# Optional: stop after a certain number of runs (0 = unlimited)
max_runs = 50

[actions]
# Tell lidarr to refresh artist when MBID transitions from timeout/unknown -> success
update_lidarr = false

[monitoring]
# Report progress every N requests
log_progress_every_n = 25
# DEBUG, INFO, WARNING, ERROR
log_level = INFO
